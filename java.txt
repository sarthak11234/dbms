package dbconnect;

import java.sql.*;       // ‚úÖ Import all JDBC classes
import java.util.Scanner;

public class DatabaseOperations {

    // üîß Update these with your database details
    private static final String URL = "jdbc:mysql://localhost:3306/testdb?serverTimezone=UTC";
    private static final String USER = "root";
    private static final String PASS = "root"; // <-- Change this

    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);

        while (true) {
            System.out.println("\n=== Database Operations Menu ===");
            System.out.println("1. Add person");
            System.out.println("2. Delete person by ID");
            System.out.println("3. Update person by ID");
            System.out.println("4. Fetch all persons");
            System.out.println("5. Fetch person by ID");
            System.out.println("6. Interactive navigation (next/prev/first/last)");
            System.out.println("0. Exit");
            System.out.print("Choose: ");

            int choice = Integer.parseInt(sc.nextLine().trim());

            try {
                switch (choice) {
                    case 1 -> addPerson(sc);
                    case 2 -> deletePerson(sc);
                    case 3 -> updatePerson(sc);
                    case 4 -> fetchAll();
                    case 5 -> fetchById(sc);
                    case 6 -> interactiveNavigation(sc);
                    case 0 -> {
                        System.out.println("Goodbye!");
                        sc.close();
                        return;
                    }
                    default -> System.out.println("Invalid option!");
                }
            } catch (SQLException e) {
                System.err.println("SQL Error: " + e.getMessage());
            } catch (Exception e) {
                System.err.println("Error: " + e.getMessage());
            }
        }
    }

    // üîπ Establish Database Connection
    private static Connection getConnection() throws SQLException {
        return DriverManager.getConnection(URL, USER, PASS);
    }

    // üîπ Add Person
    private static void addPerson(Scanner sc) throws SQLException {
        System.out.print("Enter name: ");
        String name = sc.nextLine().trim();
        System.out.print("Enter email: ");
        String email = sc.nextLine().trim();
        System.out.print("Enter age: ");
        int age = Integer.parseInt(sc.nextLine().trim());

        String sql = "INSERT INTO persons (name, email, age) VALUES (?, ?, ?)";
        try (Connection conn = getConnection(); PreparedStatement ps = conn.prepareStatement(sql)) {
            ps.setString(1, name);
            ps.setString(2, email);
            ps.setInt(3, age);
            int rows = ps.executeUpdate();
            System.out.println(rows + " row(s) inserted.");
        }
    }

    // üîπ Delete Person
    private static void deletePerson(Scanner sc) throws SQLException {
        System.out.print("Enter ID to delete: ");
        int id = Integer.parseInt(sc.nextLine().trim());
        String sql = "DELETE FROM persons WHERE id = ?";
        try (Connection conn = getConnection(); PreparedStatement ps = conn.prepareStatement(sql)) {
            ps.setInt(1, id);
            int rows = ps.executeUpdate();
            System.out.println(rows + " row(s) deleted.");
        }
    }

    // üîπ Update Person
    private static void updatePerson(Scanner sc) throws SQLException {
        System.out.print("Enter ID to update: ");
        int id = Integer.parseInt(sc.nextLine().trim());
        System.out.print("Enter new name: ");
        String name = sc.nextLine().trim();
        System.out.print("Enter new email: ");
        String email = sc.nextLine().trim();
        System.out.print("Enter new age: ");
        int age = Integer.parseInt(sc.nextLine().trim());

        String sql = "UPDATE persons SET name = ?, email = ?, age = ? WHERE id = ?";
        try (Connection conn = getConnection(); PreparedStatement ps = conn.prepareStatement(sql)) {
            ps.setString(1, name);
            ps.setString(2, email);
            ps.setInt(3, age);
            ps.setInt(4, id);
            int rows = ps.executeUpdate();
            System.out.println(rows + " row(s) updated.");
        }
    }

    // üîπ Fetch All Records
    private static void fetchAll() throws SQLException {
        String sql = "SELECT * FROM persons";
        try (Connection conn = getConnection(); Statement st = conn.createStatement(); ResultSet rs = st.executeQuery(sql)) {
            System.out.printf("%-5s %-20s %-25s %-5s%n", "ID", "Name", "Email", "Age");
            System.out.println("----------------------------------------------------");
            while (rs.next()) {
                System.out.printf("%-5d %-20s %-25s %-5d%n",
                        rs.getInt("id"),
                        rs.getString("name"),
                        rs.getString("email"),
                        rs.getInt("age"));
            }
        }
    }

    // üîπ Fetch by ID
    private static void fetchById(Scanner sc) throws SQLException {
        System.out.print("Enter ID: ");
        int id = Integer.parseInt(sc.nextLine().trim());
        String sql = "SELECT * FROM persons WHERE id = ?";
        try (Connection conn = getConnection(); PreparedStatement ps = conn.prepareStatement(sql)) {
            ps.setInt(1, id);
            try (ResultSet rs = ps.executeQuery()) {
                if (rs.next()) {
                    System.out.println("ID: " + rs.getInt("id"));
                    System.out.println("Name: " + rs.getString("name"));
                    System.out.println("Email: " + rs.getString("email"));
                    System.out.println("Age: " + rs.getInt("age"));
                } else {
                    System.out.println("No record found for ID: " + id);
                }
            }
        }
    }

    // üîπ Navigation (Next, Previous, First, Last)
    private static void interactiveNavigation(Scanner sc) throws SQLException {
        String sql = "SELECT * FROM persons ORDER BY id";
        try (Connection conn = getConnection();
             Statement st = conn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);
             ResultSet rs = st.executeQuery(sql)) {

            if (!rs.next()) {
                System.out.println("No records found.");
                return;
            }
            rs.beforeFirst();

            boolean running = true;
            while (running) {
                System.out.print("\nCommand [next|prev|first|last|exit]: ");
                String cmd = sc.nextLine().trim().toLowerCase();

                switch (cmd) {
                    case "next" -> {
                        if (rs.next()) showRecord(rs);
                        else System.out.println("Already at last record.");
                    }
                    case "prev" -> {
                        if (rs.previous()) showRecord(rs);
                        else System.out.println("Already at first record.");
                    }
                    case "first" -> {
                        rs.first();
                        showRecord(rs);
                    }
                    case "last" -> {
                        rs.last();
                        showRecord(rs);
                    }
                    case "exit" -> running = false;
                    default -> System.out.println("Invalid command.");
                }
            }
        }
    }

    // üîπ Helper function
    private static void showRecord(ResultSet rs) throws SQLException {
        System.out.println("\nCurrent Record:");
        System.out.println("ID: " + rs.getInt("id"));
        System.out.println("Name: " + rs.getString("name"));
        System.out.println("Email: " + rs.getString("email"));
        System.out.println("Age: " + rs.getInt("age"));
    }
}


---------------------------------------------

Java ‚Äì MySQL Connectivity Setup (Quick Steps)
Follow these simple steps to connect Java with MySQL using Eclipse and JDBC.
1Ô∏è‚É£ Create the Database

Open MySQL Workbench or Command Prompt and run:
CREATE DATABASE testdb;
USE testdb;

CREATE TABLE persons (
  id INT AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(100),
  email VARCHAR(100),
  age INT
);

2Ô∏è‚É£ Create a Java Project in Eclipse

1. Open Eclipse ‚Üí File ‚Üí New ‚Üí Java Project
2. Project Name: MySQLConnectivity
3. Click Finish

3Ô∏è‚É£ Create Package and Class

1. Right-click src ‚Üí New ‚Üí Package ‚Üí Name: dbconnect
2. Right-click the package ‚Üí New ‚Üí Class ‚Üí Name: TestConnection
3. Check ‚Äúpublic static void main(String[] args)‚Äù ‚Üí Click Finish

4Ô∏è‚É£ Add MySQL Connector JAR

1. Download MySQL Connector/J from: https://dev.mysql.com/downloads/connector/j/
2. In Eclipse:
   - Right-click Project ‚Üí Build Path ‚Üí Configure Build Path
   - Select Libraries tab
   - Select Classpath ‚Üí Add External JARs...
   - Choose mysql-connector-j-8.x.x.jar
   - Click Apply and Close

5Ô∏è‚É£ Write Test Connection Code

Paste this inside TestConnection.java:

6Ô∏è‚É£ Run the Program

Right-click ‚Üí Run As ‚Üí Java Application

Expected Output:
‚úÖ Connected Successfully!

7Ô∏è‚É£ If Access Denied Error Appears

Run this in MySQL:
ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'root';
FLUSH PRIVILEGES;
Then re-run your Java program.

‚úÖ You‚Äôre Done!

You now have a working Java‚ÄìMySQL connection.
Next, you can implement Add, Delete, Update, and Fetch operations easily.
